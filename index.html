<!doctype html>
<html lang="ru">
  <head>
    <title>IHTAMNET.IN.UA</title>
    <link rel="icon" type="image/x-icon" href="./images/favicon.ico">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta property="og:title" content="IHTAMNET.IN.UA" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://ihtamnet.in.ua/" />
    <meta property="og:image" content="https://ihtamnet.in.ua/images/og_image.png" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="./main.css" crossorigin="anonymous">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SB8Q63MR80"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-SB8Q63MR80');
    </script>
  </head>
  <body>
    <img src="./images/header.png" class="logo" loading="lazy" />   
    <div class="container">
      <div class="row justify-content-center main-text-row">
        <div class="col-12">
          <div class="main-text-block">
            <img class="header-logo" src="./images/Ihtam_net_logo.png" loading="lazy" />
          <div class="font-weight-bold">Внимание всем жителям Российской Федерации, а также территорий Украины, оккупированных и временно контролируемых правительством РФ.</div>
          <div class="text">
          24 февраля 2022, посреди ночи, военные силы вашей страны начали массированное вторжение, сопровождаемое применением всего самого современного оружия, находящегося в распоряжении Российской Федерации.
          </div>
          <div class="text">
          Несмотря на обещания вашего правительства взять нашу страну за несколько часов - мы успешно сопротивляемся. Ваших военных здесь никто не ждет, и мы не нуждаемся в освобождении. Миллионы граждан Украины готовы сделать все возможное для отражения атаки, которая уничтожает наши больницы, школы, дороги и города. Мы - единая многомиллионная мотивированная армия.
        </div>
        <div class="text">
          Ваши государственные СМИ врут о том, что операция проходит эффективно и практически без потерь. На самом же деле, счет убитых солдат вашей армии давно идет на тысячи, а пленных - на сотни.
        </div>
        <div class="text">
          Здесь будет публиковаться информация о всех выявленных военных, которых удалось опознать, а также их фото из обычной жизни и информация об их родственниках и знакомых. Каждый может убедиться в правдивости этой информации.
        </div>
        <div class="text"> 
          Информация разделена на две категории - <span class="font-weight-bold">пленные и мертвые</span>.
        </div>
        <div class="text">
          Мы обращаемся к вам с призывом требовать от вашего военного руководства прекратить эту войну. Идите в части, в которых служат ваши друзья и знакомые! Верните своих людей домой! Заберите погибших и остановите мясорубку. Поверьте, мы готовы стоять за нашу родину до конца!
        </div>
        </div>
          </div> 
        </div>
      </div>
    </div>

    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-light pt-5 pb-5">
        <form class="form-inline col-md-8 col-sm-12 p-0" id="searchForm">
            <span class="text-right pr-4 font-weight-normal label">Поиск</span>
            <span class="nav-search p-0">
              <button class="btn btn-outline-success my-2 my-sm-0" type="submit">
                <i class="icon-search"></i> 
              </button>
              <input class="form-control mr-0 p-0" type="search" placeholder="Введите поисковый запрос" aria-label="Search">
            </span>
          </form>
      </nav>
    </div>

    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-light pb-5">      
        <div class="col-12 nav-sort">
          <span>Сортировать по:</span>
          <span class="btn" id="sortByAlph">алфавиту</span>
          <span class="btn" id="sortByBirth">дате рождения</span>
          <span class="btn active" id="sortByDate">дате добавления</span>
      </div>
    </nav>
    </div>

    <div class="container">
      <ul class="nav">
        <li class="nav-item">
          <span class="nav-link red active" id="tabPrisoners">Пленные</span>
        </li>
        <li class="nav-item">
          <span class="nav-link black" id="tabDead">Мертвые</span>
        </li>
      </ul>

      <div class="row main-table red" id="personsGallery">
        <div class="loader"></div>
      </div>

    </div>

    <div class="row grey text-center font-weight-bold">
      <div class="col-12">ВЫ В СИЛАХ ОСТАНОВИТЬ ЭТУ ВОЙНУ</div>
    </div>

    <div class="row contacts text-center">
      <div class="col-12">Если хотите подключиться к процессу идентификации окупантов и их родственников - пишите на </div>
      <div class="col-12 important">
        <div class="col-12"><a class="no-link-style" href="mailto:ihtamnet.in.ukraine@gmail.com">ihtamnet.in.ukraine@gmail.com</a></div>
      </div>
    </div>
    <div class="row footer text-center justify-content-center">
      <div class="col-7">@ designed by <a href="">M T</a></div>
      <div class="col-7">"Сделано в бомбоубежище за час"</div>
    </div>


<!-- Modal -->
<div class="modal" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalLabel"></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <div class="container detailed-person">
          <div class="row">
            <div class="col-12 text-center mb-4" id="avatar">
              <img id="mainPhoto" loading="lazy" src=""/>
            </div>
            <div class="col-6 font-weight-bold">Номер:</div>  <div class="col-6" id="num"></div>
            <div class="col-6 font-weight-bold">Категория:</div>  <div class="col-6" id="category"></div>
            <div class="col-6 font-weight-bold">ФИО:</div>  <div class="col-6" id="fullName"></div>
            <div class="col-6 font-weight-bold">Дата рождения:</div>  <div class="col-6" id="dateOfBirth"></div>
            <div class="col-6 font-weight-bold">Военная часть:</div>  <div class="col-6" id="militaryUnit"></div>
            <div class="col-6 font-weight-bold">Ссылка на ВК:</div>  <div class="col-6" id="vk"></div>
            <div class="col-6 font-weight-bold">Ссылка на instagram:</div>  <div class="col-6" id="inst"></div>
            <div class="col-6 font-weight-bold">Источник:</div> <div class="col-6" id="linkToSource"></div>
            <div class="col-6 font-weight-bold">Информация про друзей:</div>  <div class="col-12" id="friendsInfo"></div>
            <div class="col-6 font-weight-bold">Детали:</div>  <div class="col-12" id="moreInfo"></div>
            <div class="col-6 font-weight-bold">Доп фото:</div>  
            <div class="col-12" id="morePhoto"></div>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
      </div>
    </div>
  </div>
</div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link re="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
    $( document ).ready(function() {
      var activeTab = 'Пленные'
      var data = []
      var filteredData = []
      var searchValue = ''
      var sortBy = 'date'
      var setModalData = function(person) {

        if(!modal) return

        $('#modal').modal('show')
        parent.location.hash = person.num;
        $('#mainPhoto').attr('src', person.main_photo)

        if(person.more_photo && person.more_photo.length) {
          var images = ''
          $.map(person.more_photo, function(image_url) {
            images += '<div class="col-12 mb-3"><img src="' + image_url + '" loading="lazy"></div>'
          });
          $('#morePhoto').html(images)
        }

        $('#num').html(person.num)
        $('#category').html(person.category)
        $('#fullName').html(person.full_name || '-')
        $('#modalLabel').html(person.full_name  || '-')
        $('#dateOfBirth').html(person.date_of_birth  || '-') 
        $('#militaryUnit').html(person.military_unit  || '-')

        $('#friendsInfo').html(person.friends_info || '-')
        $('#moreInfo').html(person.more_info  || '-')

        if(person.vk )$('#vk').html('<a target="_blank" href=' + person.vk + '>' + person.vk + '</a>')
        if(person.inst) $('#inst').html('<a target="_blank" href=' + person.inst + '>' + person.inst + '</a>')
        if(person.link_to_source) $('#linkToSource').html('<a target="_blank" href=' + person.link_to_source + '>' + person.link_to_source + '</a>')
      }

      var renderGallery = function(dataToRender) {
        var content = ''
        $.map(filteredData, function( val, i ) {
          content += '<div class="col-lg-4 gallery-person" id="' + i + '"> \
          <img src="' + val?.main_photo + '" loading="lazy"/> \
          <div>Номер: <span class="person-num">' + val?.num + '</span></div> \
          <div class="person-name">' + val?.full_name + '</div>\
          <div class="person-date">' + (val?.date_of_birth || '-') + '</div> \
        </div>'
        });

        $('#personsGallery').html(content)
      }

      var setGalleryByTab = function(tab) {
        if(!data) return ''
        if(tab !== 'Пленные' && tab !== 'Мертвые') return ''
        activeTab = tab
        filteredData = data.filter(function(value) {
          return value.category === tab
        })

        renderGallery(filteredData)
      }
      /////////////////////////////////////////////////////////////////////////////////////

      // $.getJSON('./db.json', function(response){
      $.getJSON('https://api.ihtamnet.in.ua/soldiers', function(response){
        data = response

        renderGallery(setGalleryByTab('Пленные'))

        const currentPersonNum = +(parent.location.hash && parent.location.hash.slice(1))
        if(currentPersonNum) {
          var person = data.find(function(value) {
            return value.num === currentPersonNum
          })
          if(person) setModalData(person)
        }
      });

      $('#tabDead').click(function(e) {
        $('#tabPrisoners').removeClass('active')
        $('#tabDead').addClass('active')

        $('#personsGallery').addClass('black')
        $('#personsGallery').removeClass('red')

        renderGallery(setGalleryByTab('Мертвые'))
      }); 
      
      $('#tabPrisoners').click(function(e) {
        $('#tabDead').removeClass('active')
        $('#tabPrisoners').addClass('active')

        $('#personsGallery').addClass('red')
        $('#personsGallery').removeClass('black')

        renderGallery(setGalleryByTab('Пленные'))
      });

      $( "#personsGallery" ).on( "click", ".gallery-person", function(e) {
        var personId = $(e.currentTarget).attr('id')
        var person = filteredData[personId]
        setModalData(person)
        $('#modal').modal('show')
      });

      $('#modal').on('hidden.bs.modal', function (e) {
        window.history.back();
      })

      $('#searchForm').on( "submit", function(e) {
        e.preventDefault()
        var newSearchValue = $('#searchForm input').val()
        if(newSearchValue === searchValue) return 
        searchValue = newSearchValue
        filteredData = data.filter(function(value) {
          return (value.full_name.toLowerCase()).includes(newSearchValue.toLowerCase())
        })
        renderGallery(filteredData)
      })

      $('#searchForm input[type="search"]').change(function(e) {
        var newSearchValue = $('#searchForm input').val()
        if(newSearchValue === '' && newSearchValue !== searchValue) {
          searchValue = newSearchValue
          renderGallery(setGalleryByTab(activeTab))
        }
      })

      $("#sortByAlph").click(function() {
        if(sortBy === 'alph') {
          renderGallery(setGalleryByTab(activeTab))
          $("#sortByAlph").removeClass('active')
          return 
        }

        filteredData = data
        .filter(function(value) {
          return value.category === activeTab
        })
        .sort(function(first, second) {
          if(first.full_name < second.full_name) { return -1; }
          if(first.full_name > second.full_name) { return 1; }
          return 0;
        })

        renderGallery(filteredData)

        sortBy = 'alph'
        $("#sortByAlph").addClass('active')
        $("#sortByDate").removeClass('active')
        $("#sortByBirth").removeClass('active')
      })

      $("#sortByDate").click(function() {
        if(sortBy === 'date') {
          renderGallery(setGalleryByTab(activeTab))
          $("#sortByDate").removeClass('active')
          return 
        }

        filteredData = data
        .filter(function(value) {
          return value.category === activeTab
        })
        .sort(function(first, second) {
          if(new Date(first.date_of_birth) < new Date(second.date_of_birth)) { return -1; }
          if(new Date(first.date_of_birth) > new Date(second.date_of_birth)) { return 1; }
          return 0;
        })

        renderGallery(filteredData)

        sortBy = 'date'
        $("#sortByDate").addClass('active')
        $("#sortByAlph").removeClass('active')
        $("#sortByBirth").removeClass('active')
      })

      $("#sortByBirth").click(function() {
        if(sortBy === 'birth') {
          renderGallery(setGalleryByTab(activeTab))
          $("#sortByBirth").removeClass('active')
          return 
        }

        filteredData = data
        .filter(function(value) {
          return value.category === activeTab
        })
        .sort(function(first, second) {
          return first.num - second.num
        })

        renderGallery(filteredData)

        sortBy = 'birth'
        $("#sortByBirth").addClass('active')
        $("#sortByDate").removeClass('active')
        $("#sortByAlph").removeClass('active')
      })
    }) 

    </script>
  </body>
</html>